import random
import pickle
import sys

# Klasa wyposażenia gracza (Equipment)
class Equipment:
    def __init__(self):
        self.headgear = None  # Czapka, hełm
        self.chest = None     # Bluza, zbroja
        self.legs = None      # Spodnie
        self.feet = None      # Buty
        self.amulet1 = None   # Amulet 1
        self.amulet2 = None   # Amulet 2
        self.ring1 = None     # Pierścień 1
        self.ring2 = None     # Pierścień 2

    def equip_item(self, slot, item):
        """Zakłada przedmiot na wybrane miejsce (slot)"""
        if slot in self.__dict__:
            self.__dict__[slot] = item
            print(f"Założono {item.name} na {slot}.")
        else:
            print("Nieprawidłowy slot.")

    def remove_item(self, slot):
        """Zdejmuje przedmiot z wybranego miejsca (slot)"""
        if slot in self.__dict__:
            removed_item = self.__dict__[slot]
            self.__dict__[slot] = None
            print(f"Zdjęto {removed_item.name} z {slot}.")
            return removed_item
        else:
            print("Nieprawidłowy slot.")
            return None

# Klasa Gracza
class Player:
    def __init__(self, name):
        self.name = name
        self.energy = 100
        self.health = 100
        self.inventory = Inventory()
        self.equipment = Equipment()
        self.strength = 1
        self.coins = 0
        self.skills = {
            'rolnictwo': Skill(),
            'zbieractwo': Skill(),
            'ryboustwo': Skill(),
            'walka': Skill(),
            'rzemiosło': Skill()
        }
        self.speed = 1
        self.luck = 1
        self.experience_points = 0

        self.inventory.add_item(Tool("Motyka"))
        self.inventory.add_item(Tool("Konewka", capacity=100))
        self.inventory.add_item(Tool("Siekiera"))
        self.inventory.add_item(Tool("Kilof"))
        self.inventory.add_item(Tool("Kosa"))
        self.inventory.add_item(Seed("Roślina nr 1", 10, 4, 1, 15, quantity=5))
        self.inventory.add_item(Seed("Roślina nr 2", 15, 6, 2, 20, quantity=5))

    def use_tool(self, tool_name, plot):
        tool = self.inventory.get_tool(tool_name)
        if not tool:
            print(f"Nie masz narzędzia: {tool_name}.")
            return
        if tool_name == "Motyka" and not plot.is_tilled:
            plot.till()
            print("Pole zostało przygotowane pod zasiew.")
        elif tool_name == "Konewka":
            if plot.is_planted and not plot.is_watered:
                if tool.use_water(2):
                    plot.water()
                    print("Pole zostało podlane.")
                else:
                    print("Konewka jest pusta. Uzupełnij wodę.")
        else:
            print(f"Użycie narzędzia {tool_name} nie jest dostępne.")

# Klasa Inventory, Tool, Seed, Plot, Skill
class Inventory:
    def __init__(self):
        self.items = []
        self.max_capacity = 10

    def add_item(self, item):
        if len(self.items) < self.max_capacity:
            self.items.append(item)
            print(f"Dodano {item.name} do ekwipunku.")

class Tool:
    def __init__(self, name, capacity=None):
        self.name = name
        self.capacity = capacity

    def use_water(self, amount):
        if self.capacity and self.capacity >= amount:
            self.capacity -= amount
            return True
        print("Za mało wody!")
        return False

class Seed:
    def __init__(self, name, purchase_cost, growth_days, yield_amount, sell_price, quantity=1):
        self.name = name
        self.growth_days = growth_days

class Plot:
    def __init__(self):
        self.is_tilled = False
        self.is_planted = False

    def till(self):
        self.is_tilled = True

    def plant(self, seed):
        self.is_planted = True
        self.seed = seed

class Skill:
    def __init__(self):
        self.level = 1
        self.experience = 0

# Klasa Game
class Game:
    def __init__(self):
        self.running = True
        self.player = Player("Gracz1")
        self.plots = [Plot() for _ in range(5)]
        self.day = 1

    def main_menu(self):
        print("\n--- Menu Główne ---")
        print("1. Zarządzaj polem uprawnym")
        print("2. Zarządzaj ekwipunkiem")
        print("3. Odpocznij (przejdź do następnego dnia)")
        print("4. Wyjdź z gry")
        choice = input("Wybierz akcję: ")
        if choice not in ["1", "2", "3", "4"]:
            print("Nieprawidłowy wybór. Spróbuj ponownie.")
            return self.main_menu()
        return choice

    def run(self):
        while self.running:
            choice = self.main_menu()
            if choice == "4":
                print("Zakończono grę.")
                self.running = False

if __name__ == "__main__":
    game = Game()
    game.run()
